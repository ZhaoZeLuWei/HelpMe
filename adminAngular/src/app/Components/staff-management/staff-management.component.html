<h2>人员管理</h2>

<table border="1" cellpadding="8">
  <tr>
    <th>用户ID</th>
    <th>姓名</th>
    <th>买家评分</th>
    <th>服务评分</th>
    <th>服务单数</th>
    <th>操作</th>
  </tr>

  <tr *ngFor="let user of users">
    <td>{{ user.UserId }}</td>
    <td>{{ user.RealName || user.UserName }}</td>
    <td>{{ user.BuyerRanking | number: "1.1-1" }}</td>
    <td>{{ user.ServiceRanking | number: "1.1-1" }}</td>
    <td>{{ user.OrderCount }}</td>
    <td>
      <button (click)="viewUserDetail(user.UserId)">查看详情</button>
    </td>
  </tr>
</table>

<!-- 用户详情弹窗 -->
<div class="modal" *ngIf="showDetailModal" (click)="closeDetail()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <span class="close" (click)="closeDetail()">&times;</span>

    <h2>用户详情</h2>

    <div *ngIf="currentUser" class="user-detail">
      <!-- 用户头像和基本信息 -->
      <div class="user-header">
        <img
          [src]="
            currentUser.UserAvatar
              ? baseUrl + currentUser.UserAvatar
              : 'assets/default-avatar.png'
          "
          alt="用户头像"
          class="user-avatar"
        />
        <div class="user-basic">
          <h3>{{ currentUser.UserName }}</h3>
          <p>{{ currentUser.RealName }}</p>
        </div>
      </div>

      <!-- 详细信息 -->
      <div class="info-section">
        <h3>基本信息</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">用户ID:</span>
            <span class="value">{{ currentUser.UserId }}</span>
          </div>
          <div class="info-item">
            <span class="label">手机号:</span>
            <span class="value">{{ currentUser.PhoneNumber }}</span>
          </div>
          <div class="info-item">
            <span class="label">身份证号:</span>
            <span class="value">{{ currentUser.IdCardNumber }}</span>
          </div>
          <div class="info-item">
            <span class="label">所在地:</span>
            <span class="value">{{ currentUser.Location }}</span>
          </div>
          <div class="info-item">
            <span class="label">出生日期:</span>
            <span class="value">{{ currentUser.BirthDate }}</span>
          </div>
          <div class="info-item">
            <span class="label">注册时间:</span>
            <span class="value">{{ currentUser.CreateTime }}</span>
          </div>
        </div>
        <div class="info-item full-width" *ngIf="currentUser.Introduction">
          <span class="label">个人简介:</span>
          <span class="value">{{ currentUser.Introduction }}</span>
        </div>
      </div>

      <!-- 评分信息 -->
      <div class="info-section">
        <h3>评分信息</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">买家评分:</span>
            <span class="value rating"
              >{{ currentUser.BuyerRanking | number: "1.1-1" }}
            </span>
          </div>
          <div class="info-item" *ngIf="currentUser.ServiceRanking !== null">
            <span class="label">服务评分:</span>
            <span class="value rating"
              >{{ currentUser.ServiceRanking | number: "1.1-1" }}
            </span>
          </div>
          <div class="info-item" *ngIf="currentUser.OrderCount !== null">
            <span class="label">服务单数:</span>
            <span class="value">{{ currentUser.OrderCount }}</span>
          </div>
          <div class="info-item" *ngIf="currentUser.ProviderRole !== null">
            <span class="label">服务类型:</span>
            <span class="value">{{
              getProviderRoleText(currentUser.ProviderRole)
            }}</span>
          </div>
          <div
            class="info-item"
            *ngIf="
              currentUser.ServiceCategory !== undefined &&
              currentUser.ServiceCategory !== null
            "
          >
            <span class="label">认证申请类别:</span>
            <span class="value">{{
              getServiceCategoryText(currentUser.ServiceCategory)
            }}</span>
          </div>
          <div
            class="info-item"
            *ngIf="
              currentUser.VerificationStatus !== null &&
              currentUser.VerificationStatus !== undefined
            "
          >
            <span class="label">认证状态:</span>
            <span class="status-badge" [ngClass]="getVerifyClass(currentUser)">
              {{ getStatusText(currentUser.VerificationStatus) }}
            </span>
          </div>
        </div>
      </div>

      <!-- 危险操作 -->
      <div class="info-section danger-zone">
        <h3>危险操作</h3>
        <p>
          删除用户将会删除该用户的所有相关数据，包括订单、事件、评论等，此操作不可恢复！
        </p>
        <button class="btn-danger" (click)="deleteUser(currentUser.UserId)">
          删除用户
        </button>
      </div>
    </div>
  </div>
</div>
